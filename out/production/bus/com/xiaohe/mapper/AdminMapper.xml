<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xiaohe.mapper.AdminMapper" >
<!-- 登陆查询验证用户名密码 -->
<select id="queryAllBus" resultType="BusList">
	select bus.*,bus_address.start_address,bus_address.end_address from bus,bus_address where bus.bus_address_id = bus_address.address_id
</select>
<select id="queryAllUsers" resultType="User">
	select * from users
</select>

<select id="queryStationList" resultType="Address">
	select * from bus_address
</select>
<select id="getBusTimes" parameterType="int" resultType="BusList">
	select bus.* ,bus_address.start_address,bus_address.end_address from bus,bus_address where bus.bus_id = #{bus_id} and bus.bus_address_id = bus_address.address_id
</select>
<insert id="setUsersInfor" parameterType="users">
	insert into users (user_name,user_password) value (#{user_name},#{user_password})
	<selectKey keyProperty="user_id" order="AFTER" resultType="int">
		SELECT LAST_INSERT_ID()
	</selectKey>
</insert>

<insert id="addAddress" parameterType="Address">
	insert into bus_address (start_address,end_address,seat) value (#{start_address},#{end_address},#{seat})
</insert>
<insert id="setBusTimes" parameterType="Bus">
	insert into bus (bus_number,run_time,start_time,end_time,bus_price,bus_seats,bus_times,bus_address_id)
	 value (#{bus_number},#{run_time},#{start_time},#{end_time},#{bus_price},#{bus_seates},#{bus_times},#{bus_address_id})
</insert>
<delete id="deleteUser" parameterType="int">
	 delete from users where user_id = #{user_id}
</delete>
<delete id="deleteBusId" parameterType="int">
	 delete from bus where bus_id = #{bus_id}
</delete>
<delete id="deleteStationId" parameterType="int">
	 delete from bus_address where address_id = #{address_id}
</delete>
 <update id="computeMoenry" parameterType="SetUserMoney">
        update users set user_money=#{user_money} where user_id=#{user_id}
 </update>
 
  <update id="setMoney" parameterType="SetUserMoney">
        update users set user_money=user_money + #{user_money} where user_id=#{user_id}
 </update>
</mapper>